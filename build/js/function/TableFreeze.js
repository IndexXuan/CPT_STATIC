$.fn.mergeAttributes=function(src){if($.browser.msie)$(this).get(0).mergeAttributes(src.get(0));else for(attrs=src.get(0).attributes,i=attrs.length-1;i>=0;i--){var name=attrs[i].name;if("id"!==name.toLowerCase()&&""!=attrs[i].value&&null!=attrs[i].value&&"null"!=attrs[i].value)try{$(this).attr(name,attrs[i].value)}catch(e){}}},$.fn.FrozenTable=function(iRowHead,iRowFoot,iColLeft){var oTable=$(this),oTableId=oTable.attr("id"),oDiv=$(this).parent();if("DIV"==oDiv.get(0).tagName){if(oTable.find("td").attr("noWrap","nowrap"),oTable.width()>oDiv.width()&&oTable.height()>oDiv.height()){if(iRowHead>0&&iColLeft>0){var oCloneTable=$("<table id='oTableLH_"+oTableId+"'></table>");oDiv.parent().append(oCloneTable),oCloneTable.CloneTable(oTable,0,iRowHead,iColLeft),oCloneTable.css("position","absolute"),oCloneTable.css("z-index","1004"),oCloneTable.css("left",oDiv.offset().left),oCloneTable.css("top",oDiv.offset().top)}if(iRowFoot>0&&iColLeft>0){var oCloneTable=$("<table id='oTableLF_"+oTableId+"'></table>");oDiv.parent().append(oCloneTable),oCloneTable.CloneTable(oTable,oTable.find("tr").length-iRowFoot,oTable.find("tr").length,iColLeft),oCloneTable.css("position","absolute"),oCloneTable.css("z-index","1003"),oCloneTable.css("left",oDiv.offset().left),oCloneTable.css("top",oDiv.offset().top+oDiv.outerHeight(!0)-oCloneTable.outerHeight(!0)-17)}}if(iRowHead>0&&oTable.height()>oDiv.height()){var oCloneDiv=$("<div id='oDivH_"+oTableId+"'><table></table></div>");oDiv.parent().append(oCloneDiv),oCloneDiv.find("table").CloneTable(oTable,0,iRowHead,-1),oCloneDiv.css("overflow","hidden"),oCloneDiv.css("width",oDiv.outerWidth(!0)-17),oCloneDiv.css("position","absolute"),oCloneDiv.css("z-index","1002"),oCloneDiv.css("left",oDiv.offset().left),oCloneDiv.css("top",oDiv.offset().top)}if(iRowFoot>0&&oTable.height()>oDiv.height()){var oCloneDiv=$("<div id='oDivF_"+oTableId+"'><table></table></div>");oDiv.parent().append(oCloneDiv),oCloneDiv.find("table").CloneTable(oTable,oTable.find("tr").length-iRowFoot,oTable.find("tr").length,-1),oCloneDiv.css("overflow","hidden"),oCloneDiv.css("width",oDiv.outerWidth(!0)-17),oCloneDiv.css("position","absolute"),oCloneDiv.css("z-index","1001"),oCloneDiv.css("left",oDiv.offset().left),oCloneDiv.css("top",oDiv.offset().top+oDiv.outerHeight(!0)-oCloneTable.outerHeight(!0)-17)}if(iColLeft>0&&oTable.width()>oDiv.width()){var oCloneDiv=$("<div id='oDivL_"+oTableId+"'><table></table></div>");oDiv.parent().append(oCloneDiv),oCloneDiv.find("table").CloneTable(oTable,0,oTable.find("tr").length,iColLeft),oCloneDiv.css("overflow","hidden"),oCloneDiv.css("height",oDiv.outerHeight(!0)-17),oCloneDiv.css("position","absolute"),oCloneDiv.css("z-index","1000"),oCloneDiv.css("left",oDiv.offset().left),oCloneDiv.css("top",oDiv.offset().top)}oDiv.scroll(function(){"undefined"!=typeof $("#oDivH_"+oTableId).get(0)&&$("#oDivH_"+oTableId).scrollLeft($(this).scrollLeft()),"undefined"!=typeof $("#oDivF_"+oTableId).get(0)&&$("#oDivF_"+oTableId).scrollLeft($(this).scrollLeft()),"undefined"!=typeof $("#oDivL_"+oTableId).get(0)&&$("#oDivL_"+oTableId).scrollTop($(this).scrollTop())})}},$.fn.CloneTable=function(oSrcTable,iRowStart,iRowEnd,iColumnEnd){var iWidth=0,iHeight=0;$(this).mergeAttributes(oSrcTable);for(var rowIndex,Log="",rowspanValue=0,rowNumber=0,i=iRowStart;iRowEnd>i;i++){for(var oldTr=oSrcTable.find("tr").eq(i),isSingleRowspan=!1,rowspanCount=0,colCount=0,colNumber=0,j=0;j<(-1==iColumnEnd?oldTr.find("td").length:iColumnEnd);j++){var oidTd=oldTr.find("td").eq(j);colNumber++;var colspan=oidTd.attr("colspan");colCount+="undefined"==typeof colspan||1==colspan?1:colspan;var rowspan=oidTd.attr("rowspan");if("undefined"!=typeof rowspan&&1!=rowspan&&(rowspanCount++,rowIndex=i,rowspanValue=rowspan,rowNumber=rowspanCount),colCount>=iColumnEnd&&-1!=iColumnEnd)break}if(Log+=i+"=="+rowIndex+"="+rowspanCount+"="+rowNumber+"="+rowspanValue+"<br>",i>rowIndex&&rowIndex+rowspanValue-1>=i&&-1!=iColumnEnd&&(0!=rowNumber&&iColumnEnd==rowNumber?isSingleRowspan=!0:(colNumber-=1,0==rowspanCount&&(colNumber-=rowNumber-1))),0!=colNumber){var newTr=$("<tr></tr>");newTr.mergeAttributes(oldTr);var jWidth=0;iHeight+=oldTr.outerHeight(!0);for(var j=0;colNumber>j;j++)if(!isSingleRowspan){var oidTd=oldTr.find("td").eq(j),newTd=oidTd.clone();newTd.height(oidTd.outerHeight(!0)),newTd.width(oidTd.outerWidth(!0)),jWidth+=oidTd.outerWidth(!0),iWidth=Math.max(iWidth,jWidth),newTr.append(newTd)}$(this).append(newTr)}}$(this).width(iWidth),$(this).height(iHeight)};